rules:
  - name: Travis CI Token
    id: kingfisher.travisci.1
    pattern: |
      (?x)
      (?i)
      \b
      travis
      (?:.|[\\n\r]){0,16}?
      (?:SECRET|PRIVATE|ACCESS|KEY|TOKEN)
      (?:.|[\n\r]){0,16}?
      \b
      (
        [a-z0-9-_]{22}
      )
      \b
    min_entropy: 3.0
    confidence: medium
    examples:
      - "travis_token splendid21RANDOMCONTENT_token"
    validation:
        type: Http
        content:
          request:
            method: GET
            url: https://api.travis-ci.com/repos?limit=1
            headers:
              Authorization: token {{ TOKEN }}
              Accept: application/vnd.travis-ci.3+json
              Travis-API-Version: "3"
            response_matcher:
              - report_response: true
              - type: StatusMatch
                status: [200]
